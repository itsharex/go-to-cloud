package kube

import (
	"context"
	"github.com/stretchr/testify/assert"
	"testing"
)

func TestListDeployments(t *testing.T) {
	if testing.Short() {
		t.Skip()
	}
	conf :=
		`apiVersion: v1
clusters:
- cluster:
    certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUMvakNDQWVhZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJek1ESXlOREV3TXpFeU5Wb1hEVE16TURJeU1URXdNekV5TlZvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBSmlTCnJPUVgyL0ZZUE1oVEI2UUZuZm5Ud2dLQVd6dE11RW94R3R6WFpRYWdqbkxEcktCVldScFg3UkRLblVsdGhTT1UKejRadXFtM2FRMEppQ0pBZ2E0eXAzVng0NkdkUHZ6YWZNUW1wY1Q5MWE5bk1tY1Fac0RuSlptcytZbXo3V21yQwo3MC9oNittWDhRdGJkaVVia2R0UWlzOVVwRDlZVTdBbVJQZ0VsRDVmZ0R1RkZMZVNtVTF4dHlVM3NzMWErUmdsCkRQQWJqdTUwL2VLTXpLcU9EMUIxdHQ4ek1VS3JSUmdSeE5uaFE2ZXRMNEpyZ2dQZkNHZmYzN1NMY29PcThiM3cKbnQvQzBWWXZZa0VpTzBsU3A0aG1mbGF4UXJaMFB3c05IWktKMmRldGFEY2tSQk1PbXpoSW16OUdtS0pEU2VxawpOM25sWlB3dUNQZWVvcklpdUhFQ0F3RUFBYU5aTUZjd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZMQW1nMW80ZStFRVlqNHBCaVZtRHJoVUxvOVBNQlVHQTFVZEVRUU8KTUF5Q0NtdDFZbVZ5Ym1WMFpYTXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBSGF2QXNJSllPUldaV1c2aVhMeQpLZkhCa1ZTSXEweFB4MHZHdnMvK1lRUy9tekljQXpSbTArZWx6aXF1eEF1dFY0bjJiQXZaY2xaRkt5dEVUY25pCk1NT0hTSkVQUDdjTzVBUDB1TkMxcTVLOXpVUVBVWE9zK25TQ0tYVU10T0ZueHNqbStJazE2WTRxVFAzUFVvMTMKMmNYRnZVdVpSTm5qUjl6ZGhHQWRpY1MrZEFyV0pab2UzNUpudmZzS0E2bVdwZWJ2WmxDYk1ZVXFCaTYyVUpydgovSzNUd2EyWE5zbUxJQVFZRm1zOXlGQmJUWU92Q1dYbXZtenliNkkzcThYK2ZuVU1BS04vUWs5OTZyMExFcnBGCkFYWnNqMXpiNGtpQWNISHQ4NE9JL0VZYjlVOHJzU2UyaHdOaC9qbm12aWFmZ1RqWGcwNE1YT1NNMmlPYWk1TjMKZ2hnPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
    server: https://kubernetes.docker.internal:6443
  name: docker-desktop
contexts:
- context:
    cluster: docker-desktop
    user: docker-desktop
  name: docker-desktop
current-context: docker-desktop
kind: Config
preferences: {}
users:
- name: docker-desktop
  user:
    client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURRakNDQWlxZ0F3SUJBZ0lJUUhLMGVXWHpIK1V3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TXpBeU1qUXhNRE14TWpWYUZ3MHlOREF5TWpReE1ETXhNamxhTURZeApGekFWQmdOVkJBb1REbk41YzNSbGJUcHRZWE4wWlhKek1Sc3dHUVlEVlFRREV4SmtiMk5yWlhJdFptOXlMV1JsCmMydDBiM0F3Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRQ3ZrSjRDdlVSTlk0eCsKOTI4dGxhQUFtSmhWYks1eEh6NXNNNEZhd09SMkw5TzAvZ0xEcEY2YW05czdHZ09sS2huUkdOT1puMWtWSXV1dgpYakpkMHhjdS8yTlFtMWg5cGtjc29ZelhmeDJndVF6amh6c05RMjdrenVyR1VPQlcrc1pkUnJmMWpMMnBndm5nCnhLT05DOFUra3Z6WTQ2YjdNSFlXRmhBcmNabFhsWE1EdThmK3drQmNmaDJzazlEWVFqaGZSZmE3UWhGVW9GM2sKWHpNK0dmckhTYzBiSzJFRGFOK2Q5YVpZUHNVR1NFK3JGcEtyZ1kydDFVckFlc3hKR3dOdmhMckRHMzhGbUZkago1RlFwNnFkdk8yR2lvWWZMU0dOV0FZOTNTQ2VFUHVJRTBVamMrbzhTOElZZzMvdXNhUlcvanFuT00vNnQ5M2YxCmZWUXJJNHZuQWdNQkFBR2pkVEJ6TUE0R0ExVWREd0VCL3dRRUF3SUZvREFUQmdOVkhTVUVEREFLQmdnckJnRUYKQlFjREFqQU1CZ05WSFJNQkFmOEVBakFBTUI4R0ExVWRJd1FZTUJhQUZMQW1nMW80ZStFRVlqNHBCaVZtRHJoVQpMbzlQTUIwR0ExVWRFUVFXTUJTQ0VtUnZZMnRsY2kxbWIzSXRaR1Z6YTNSdmNEQU5CZ2txaGtpRzl3MEJBUXNGCkFBT0NBUUVBRFFxanNKeXRjajZvdlBXZ1VMSVN2Q3krNVRtWWpGOWlzTFBzbFlGeUZEeGxRUDZ2MG1veGhJRDAKV1VZU0M5ckRRRnhkSitRZFVxdHBzYmVvUUg0WHpJN2dndUlKaEdENFREZDRSakNEOTNDTlNubm1HbFRaZDA3RgpkdzdqMHlLSW52alB5cGFPTVlHU2hmdzJrTGNYdkIzTWFxTUV5V25PZHpjSUo1aDB1UkRJU2tVL3NBZlBMT2xXClkvQUREZ3BoVHI4aG4ySFN5S0tBVitCYkRJaU41ZkR5T29HY3Nidlp3ZnM2MlBLSHE4bTZhZjN3Z0ZKbkc1RXoKUDUzS0xBN21yWDlpdmw5Y000cE1JNmdSd0RGdGlLcXE5M093TzBtTlN5U0ZEcExTaGlLL1JnMTF2c0RzaVoxcgpNbkJPYlNKaTNiZ3ZIeEl4TTJCTkovaDVZb1M4VWc9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
    client-key-data: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBcjVDZUFyMUVUV09NZnZkdkxaV2dBSmlZVld5dWNSOCtiRE9CV3NEa2RpL1R0UDRDCnc2UmVtcHZiT3hvRHBTb1owUmpUbVo5WkZTTHJyMTR5WGRNWEx2OWpVSnRZZmFaSExLR00xMzhkb0xrTTQ0YzcKRFVOdTVNN3F4bERnVnZyR1hVYTM5WXk5cVlMNTRNU2pqUXZGUHBMODJPT20rekIyRmhZUUszR1pWNVZ6QTd2SAovc0pBWEg0ZHJKUFEyRUk0WDBYMnUwSVJWS0JkNUY4elBobjZ4MG5OR3l0aEEyamZuZldtV0Q3RkJraFBxeGFTCnE0R05yZFZLd0hyTVNSc0RiNFM2d3h0L0JaaFhZK1JVS2VxbmJ6dGhvcUdIeTBoalZnR1BkMGduaEQ3aUJORkkKM1BxUEV2Q0dJTi83ckdrVnY0NnB6alArcmZkMzlYMVVLeU9MNXdJREFRQUJBb0lCQUdSendKVWNxZ29Gbll2QQpFNUxuZTZjYnFIMm9NNTl5R3d0WjVQZUNTclg4NDRzNWsyZFJrdmV2bVo2VlllU00xRHk1a2NqaVRkdzBJTm8wCmNXa1JzTUFwVERBQTBuOENOdE1vbENkeENnaStHTXZPd2xEeWRtN2duYUJmQWgyQ1d5RmZwejRPQ3k4RVMrajUKV2dNSDZ4SEVsSHVjdGh3ZlBGR2l5aG14WStXaUlHQUZ1ZXArYjkwKzR6Sis1MXN1RDdUeEoyNUQvUDVZZUFXQwo0ZVhXVVRIQjNESXBGZW9mZEJyRy85SlJZUUxXSHBncStURzl4NXBmTG5RZWlBdWJmdUFhbHFUcmdMNGRmWEpvCnBZMjdxclVuUWVhbHVkZTEwN3NZTncrTy9UZHk0bFF0dVowMzRUekhqL1dEMlZnbnoxdzBrbWdqZDZGL0dmdEwKUm9oQ0wyRUNnWUVBeTNwQmpkSlA1eTRYUFFoRWtCeVpWTUx1WDluVkIvQXJFaFVPWmtwaUN0ZmRibkp5K0tDRwpNVWlZM2hLVkFHanZpZ2NVNWgzTzFmcHdGWTg1dm1qQWRuQ2VQSDRtKy9Ja3pqTjJnVCszSXBKVG9aS3AxUUxBClc3T3dhbHZSU0ZqZktxeGQrR0dQdWpSV2RWWDEyWm82TGwzc1lMUHh2VGxiZnlxdmwzTUtWVzhDZ1lFQTNPSG0KaEowekVyQUFSeUlvaTJ1UnFGRmpuYllwQU9rMDVxeWd6Y1F2NzQxcndYSXc0SVVsMkFFS2d6TnRRZitYK3dhcwplaC9LT0grZElSSXlzK0dxNms5dmlMRFZ1WEwxdXZqNnJlL2krLzB2QitralVkdGp6eldNa1AxVVdWZk5zNEJmCjR0VmpLeUdqUnV4elJNUVdkMlFDbkZ3MWN5TFVnTk10dlhXcXBRa0NnWUJZSjJKSk9DbUg1YThKc1JCTFF5aW0KMFVFRzQ4L29mWU9iZE9YbEtTcXF1ZlRrQ2MrSHFid1prL011bXV4VTNpR1JNaG82ekFVMUxTZnNIejRNSVVQbwp6RWV4dTVIV0s0VUlsTUV0bzlZS3MweHFQcWszY05hM28vUzFUNHd2Qk5uQ21pU29IRlJ4Zm9WS2xuQkowd2lMCjJBTTFyaC80TStaUkJNUklILzRGSHdLQmdDaXFwcWhQMFBGbDJnYytzTHhLaDd5M2oyR2dBaGlhMXhTSlArbmkKYnZqcHpxY0ZBUjYxSk95SjlJZUhWbHhLVkk3eEFaeFNjZ2JJNkFNSXVMRUpvVkFXWS9DRXJqVEFoNkZ1NmFoUQpmRGZzdTFYM2hIc3pxMEtoRjBveWVlOGhEVXc1SEc1RTMwYzNvRG9VbW54VXBkWkJZWUdzTUdNTVRKZVRTZDZSCjVXTVJBb0dCQUxMS0JTbXRzNDk2L1hpN29pS0FuRHZ2QzFNckVDcFhxVXZ4S1lVUHdiQ0h4QW9wcjF3MWV5eEMKR0JyVmF1YnFteGxkWmRKZklhb2JJbHJXN0hJaTZudnhhSTcrekczRmJaL2xEWHZqdXQvTXpMcE5xVHQxWlFBaQoraStPNnlCd0UrYmJIM1pjU0xRNDhVUnFtZXMzZ3Bmb2tUVlNhT2t6L29KVnB2N3JDUXRYCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==`
	kubeClient, err := NewClient(&conf)
	assert.NoError(t, err)

	m := make(map[uint]bool)
	m[1] = true
	lst, err2 := kubeClient.GetDeployments(context.TODO(), "default", &m)
	assert.NoError(t, err2)

	assert.NotEmpty(t, lst)
}
